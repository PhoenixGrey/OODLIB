(function(){var a,b,c,d;d=function(){function a(a){this.data=a}return a}(),a=function(){function a(){}return a}(),b=function(){function b(b,c,e){var f;this.modelKlass=c||d,this.cssKlass=e||a,this.params={restrict:"E",templateUrl:"",scope:{storage:"=info"}},f=this.params.scope,b&&b.scope&&(f=_.extend(this.params.scope,b.scope)),_.extend(this.params,b),this.params.scope=f,this.initLink()}return b.prototype.linkFn=function(a,b,c){return this.scope=a,_.extend(a,{model:new this.modelKlass(a.storage),css:this.cssKlass})},b.prototype.initLink=function(){return this.params.link=function(a){return function(b,c,d){return a.linkFn(b,c,d)}}(this)},b}(),c=function(){function a(){}return a.register=function(a,b,c){return a.directive(b,function(){return c.params})},a}(),this.Model=d,this.CssManager=a,this.DirectiveSchool=c,this.Directive=b}).call(this),function(){var a,b,c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d="lib/table/",a=function(a){function b(a){this.rawData=null!=a?a:[],this.initTable()}return e(b,a),b.prototype.initTable=function(){return this.initFields(),this.initSorting(),this.setPagination(),this.updateTableData(),this.updateCurrentPage()},b.prototype.initFields=function(){return this.fieldsSample=_.has(this.rawData,"0")?this.rawData[0]:{},this.fields=this.detailFields=this.columnFields=_.keys(this.fieldsSample)},b.prototype.initSorting=function(){return this.sort=_.mapObject(this.fieldsSample,function(a){var b;return b={fn:_.identity,order:0}})},b.prototype.updateTableData=function(){return this.data=_.map(this.rawData,function(a){return function(b){var c;return c={},c.columnData=_.pick(b,a.columnFields),c.detailData=_.pick(b,a.detailFields),c}}(this))},b.prototype.setPagination=function(a,b){var c;return this.numPerPage=null!=b?b:2,this.numPages=Math.ceil(this.rawData.length/this.numPerPage),this.currentPage=null!=a?a:1,this.pageRange=0===this.numPages?[]:function(){c=[];for(var a=1,b=this.numPages;b>=1?b>=a:a>=b;b>=1?a++:a--)c.push(a);return c}.apply(this)},b.prototype.updateCurrentPage=function(){return this.from=(this.currentPage-1)*this.numPerPage,this.to=this.from+this.numPerPage-1,this.currentData=this.data.slice(this.from,+this.to+1||9e9),this.activeDetailIndex=-1},b.prototype.resetOrder=function(a,b){return _.each(this.sort,function(c,d){return d!==a?c.order=0:c.order=b})},b.prototype.sortBy=function(a){var b,c;return b=this.sort[a].order,c=0===b?-1:-b,this.rawData=_.sortBy(this.rawData,function(b){return function(c){return b.sort[a].fn(c[a])}}(this)),-1===c&&this.rawData.reverse(),this.resetOrder(a,c),this.updateTableData(),this.updateCurrentPage()},b.prototype.setCurrentPage=function(a){return 0>=a?a=1:a>=this.numPages&&(a=this.numPages),this.setPagination(a,this.numPerPage),this.updateCurrentPage()},b.prototype.setFields=function(a,b){return this.columnFields=_.intersection(a,this.fields),this.detailFields=_.intersection(b,this.fields),this.updateTableData(),this.updateCurrentPage()},b.prototype.setTitles=function(a){return this.titles=_.mapObject(this.fieldsSample,function(b,c){var d,e;return e=null!=(d=a&&a[c])?d:c})},b.prototype.getTitle=function(a){return this.titles[a]},b.prototype.toggleDetail=function(a){return this.activeDetailIndex=this.activeDetailIndex!==a?a:-1},b.prototype.detailDisplayed=function(a){return a===this.activeDetailIndex},b}(Model),b=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.brief=function(a){},b.detail=function(a){},b.td=function(a){},b.cellContent=function(a,b){},b.cellIcon=function(a,b){var c;return c=function(){switch(a){case"nickname":return"fa fa-desktop";case"groupName":return"fa fa-client-group";default:return"hide"}}()},b.cell=function(a,b){var c;return c=function(){switch(!1){case!("nickname"===a||"groupName"===a):return"td-icon"}}()},b.sortState=function(a,b){switch(a[b].order){case-1:return"fa-sort-up";case 1:return"fa-sort-down";default:return"fa-sort"}},b.pageState=function(a,b){var c;return c=function(){switch(!1){case a!==b:return"is-active"}}()},b.prevPageState=function(a){var b;return b=function(){switch(!1){case 1!==a:return"is-disabled"}}()},b.nextPageState=function(a,b){var c;return c=function(){switch(!1){case a!==b:return"is-disabled"}}()},b}(CssManager),c=function(c){function f(c,e){var g;c=null!=c?c:{},e=null!=e?e:b,g={templateUrl:d+"table.html",scope:{cFields:"=cFields",dFields:"=dFields",numPerPage:"=numPerPage",titles:"=titles"}},_.extend(c,g),f.__super__.constructor.call(this,c,a,e)}return e(f,c),f.prototype.linkFn=function(a,b,c){var d,e;return f.__super__.linkFn.call(this,a,b,c),a.model.setPagination(1,a.numPerPage),a.cFields=null!=(d=a.cFields)?d:a.model.fields,a.dFields=null!=(e=a.dFields)?e:a.model.fields,a.model.setFields(a.cFields,a.dFields),a.model.setTitles(a.titles)},f}(Directive),this.TableDirective=c,this.TableCssManager=b}.call(this),function(){var a,b,c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d="lib/footer/",a=function(a){function b(a){var b;b={copyright:"EMPTY copyright",version:"EMPTY version",websites:[]},this.rawData=_.extend(b,a),this.copyright=this.rawData.copyright,this.version=this.rawData.version,this.websites=this.rawData.websites,this.lenOfSites=this.rawData.websites.length}return e(b,a),b.prototype.getLink=function(a){return _.values(a)[0]},b.prototype.getName=function(a){return _.keys(a)[0]},b}(Model),b=function(){function a(){}return a}(),c=function(c){function f(c){var e;c=null!=c?c:{},e={templateUrl:d+"footer.html"},_.extend(c,e),f.__super__.constructor.call(this,c,a,b)}return e(f,c),f}(Directive),this.FooterDirective=c}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;i="lib/aside/",a=0,g=1,e=0,f=1,j=function(a){var b;return b={},_.each(a,function(a){return _.extend(b,a)}),b},c=function(){function b(){}return b.getState=function(b){switch(b){case a:return"is-active";case g:return""}},b.getExpansion=function(a){switch(a){case e:return"fa fa-angle-down";case f:return"fa fa-angle-up";default:return""}},b.expanded=function(a){switch(a){case e:return!1;case f:return!0;default:return""}},b}(),h=function(){function b(a,b,c){this.id=a,this.hasChildren=void 0!==b.subnodes,this.hasFather=c,this.expansion=this.hasChildren?e:void 0,this.activation=g}return b.prototype.changeState=function(b,c,d){var h,i,j;return h=c,i=d,void 0!==this.expansion?this.expansion=this.expansion===e?f:e:(null!==c&&(b[c].activation=g),this.activation=a,h=this.id,this.hasFather&&(b[this.hasFather].expansion=f,i=this.hasFather)),j={activatedKey:h,expandedKey:i}},b}(),b=function(a){function b(a){this.rawData=a,this.initStates()}return k(b,a),b.prototype.initStates=function(){var a;return a=_.map(this.rawData,function(a,b){var c,d;return d=_.map(a,function(a,b){var c,d;return c={},c[b]=new h(b,a,!1),d=_.mapObject(a.subnodes,function(a,c){return new h(c,a,b)}),_.extend(c,d),c}),c=j(d)}),this.states=j(a),this.expandedKey=null,this.activatedKey=null},b.prototype.setStates=function(a){var b;return a=void 0!==a&&""!==a?a:this.activatedKey||_.keys(this.states)[0],b=this.states[a].changeState(this.states,this.activatedKey,this.expandedKey),this.expandedKey=b.expandedKey,this.activatedKey=b.activatedKey},b.prototype["goto"]=function(a){return this.setStates(a)},b}(Model),d=function(a){function d(a,e){var f;a=null!=a?a:{},e=null!=e?e:c,f={templateUrl:i+"aside.html",scope:{activeItem:"="}},_.extend(a,f),d.__super__.constructor.call(this,a,b,e)}return k(d,a),d.prototype.linkFn=function(a,b,c){return d.__super__.linkFn.call(this,a,b,c),a.$watch(function(){return a.activeItem},function(b,c){return a.setActiveItem(b),console.log(b)}),a.setActiveItem=function(b){return a.activeItem=b,a.model.setStates(a.activeItem)}},d}(Directive),this.AsideDirective=d}.call(this),function(){var a,b,c,d;d=angular.module("OODLib",["gettext"]),d.run(["gettextCatalog",function(a){return a.currentLanguage="zh",a.debug=!0}]),this.OOD=d,b=new TableDirective,DirectiveSchool.register(OOD,"ctable",b),c=new FooterDirective,DirectiveSchool.register(OOD,"cfooter",c),a=new AsideDirective,DirectiveSchool.register(OOD,"caside",a)}.call(this),angular.module("gettext").run(["gettextCatalog",function(a){a.setStrings("zh",{details:"详情",records:"条记录",total:"总共"})}]),angular.module("OODLib").run(["$templateCache",function(a){a.put("lib/aside/aside.html",'<sidebar> <ul ng-repeat="section in model.rawData" class="menu"> <li ng-repeat="(nid, nObj) in section" ng-class="css.getState(model.states[nid].activation)"><a ng-href="{{nObj.URL}}" ng-click="model.setStates(nid)"><i ng-class="nObj.icon"></i><span>{{nObj.name}}</span><i ng-class="css.getExpansion(model.states[nid].expansion)" class="is-align-right"></i></a> <ul ng-show="css.expanded(model.states[nid].expansion)" class="menu"> <li ng-repeat="(subNId, subNObj) in nObj.subnodes" ng-class="css.getState(model.states[ subNId].activation)"><a ng-href="{{subNObj.URL}}"><i ng-class="subNObj.icon"></i><span>{{subNObj.name}}</span></a></li> </ul> </li> </ul> </sidebar>'),a.put("lib/footer/footer.html",'<footer><span class="copyright">Copyright © {{model.copyright}} | Version: {{model.version}}</span><span class="help"><span ng-repeat="site in model.websites"><a ng-href="{{model.getLink(site)}}">&nbsp;{{model.getName(site)}}&nbsp;</a><span ng-show="{{$index}}&lt;{{model.lenOfSites-1}}">|</span></span></span></footer>'),a.put("lib/table/table.html",'<div class="responsive"> <table class="table table-sort table-detail-default table-stripped-4"> <thead> <tr> <th ng-repeat="t in model.columnFields" ng-click="model.sortBy(t)"> <span ng-bind="model.getTitle(t)"></span><i ng-class="css.sortState(model.sort, t)" class="fa"></i></th> </tr> </thead> <tbody> <tr ng-repeat-start="item in model.currentData" ng-click="model.toggleDetail($index)" ng-class="css.brief(item)"> <td ng-repeat="(k,v) in item.columnData" ng-class="css.td(item.columnData)"> <div ng-class="css.cell(k,v)"><i ng-class="css.cellIcon(k,v)"></i><span ng-bind="v" class="css.cellContent(k,v)"></span></div> </td> </tr> <tr ng-repeat-end="ng-repeat-end" ng-show="model.detailDisplayed($index)" ng-class="css.detail(item)"> <td colspan="{{model.columnFields.length}}" class="is-nopadding"> <div class="detail-default"> <div translate="translate" class="detail-title">details</div> <dl> <dt ng-repeat-start="(k,v) in item.detailData">{{model.getTitle(k)}}:</dt> <dd ng-repeat-end="(k,v) in item.detailData">{{v}}</dd> </dl> </div> </td> </tr> </tbody> </table> <div ng-show="model.data.length&gt;0" class="statistics"> <span> <span translate="translate">total</span><span ng-bind="model.data.length"> </span><span translate="translate">records</span></span> <ul class="pagination"> <li ng-class="css.prevPageState(model.currentPage)" ng-click="model.setCurrentPage(model.currentPage-1)"><a href="#">«</a></li> <li ng-repeat="i in model.pageRange" ng-click="model.setCurrentPage(i)" ng-class="css.pageState(model.currentPage, i)"><a href="#">{{i}}</a></li> <li ng-class="css.nextPageState(model.currentPage, model.numPages)" ng-click="model.setCurrentPage(model.currentPage+1)"><a href="#">»</a></li> </ul> </div> </div>'),a.put("lib/topbar/topbarDropdown.html",'<ul class="dropdown-menu"> <li class="header">{{ model.data.name }}</li> <li> <ul class="menu"> <li ng-repeat="(k, v) in model.data"><a ng-href="{{v.URL}}" ng-click="model.toggle(k)"><i ng-class="v.icon" class="floatLeft"><span class="floatLeft"><small class="topBar_small"></small></span><span class="floatLeft">{{ v.name }}<small ng-bind="v.count" class="topBar_small_chrono"></small></span></i><i ng-class="css.arrowIcon(model.expansion, k)"></i> <ul ng-show="model.expanded(k)"> <li ng-repeat="(k, v) in v.subnodes">{{ k }}:&nbsp;&nbsp;{{ v }}</li> </ul></a></li> </ul> </li> <li class="footer"> <ul> <li ng-repeat="(k, v) in model.data.footerInfo">{{ k }}:&nbsp;&nbsp;{{ v }}</li> </ul> </li> </ul>')}]);